---
title: "Does the Interner Accessibility Improve Student's Ability?"
author: "Pol De Santal√≥ & Yumi Komai"
date: "December 2, 2016"
output:
  beamer_presentation:
    colortheme: beaver
    fig_height: 5
    fig_width: 8
    slide_level: 2
    theme: CambridgeUS
header-includes: \usepackage{graphicx} \usepackage{booktabs}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
library(magrittr)  
library(ggplot2)
library(interplot)  
library(dplyr)  
library(devtools)
library(xlsx)
library(knitr)
library(DAAG)
```

```{r , echo=FALSE, comment=NA, warning=FALSE, error=FALSE, message=FALSE, results='asis'}
##Data install
data <- read.xlsx("/Users/komaiyumi/Desktop/Social Sicence/web/Data/PISA_Data.xlsx",1)

##Data Cleaning
cdata <- subset(data, select = c(1,3,4,5,6,7,9,10,12,14,16,17))
cdata <- cdata[,c(1,3,2,4,7,8,9,10,11,12,5,6)]

#For Growth comparison
##Data install
pisa <- read.xlsx("/Users/komaiyumi/Desktop/Social Sicence/web/Data/PISA_Data.xlsx",2)
pisa <- pisa[1:41,]
```

##Outline
1. Introduction
2. Research Question
3. Data
4. Methodology
5. Analysis
6. Result


##Methodology(Dependent Variables)

|Dependent Variable|Variable Name|Description|
|:--------|:------------------|:------------------------|
|DV|math|Mathmatics mean score(2012)|
|DV|reading|Readind mean score(2012)|
|DV|ps|Prolem Solving mean score(2012)|

##Methodology(Independent Variables)
|Indivendent Variable|Variable Name|Description|
|:--------|:---------------|:---------------------------|
|IV|GDPperc|GDP per Capita (current US$)|
|IV|expend|Government expenditure on education, total (% of GDP)|
|IV|pop|Population, total|
|IV|popd| Population density (people per sq. km of land area)
|IV|rteacher|Primary school pupil-teacher ratio|
|IV|eyear|Number of years that children are legally obliged to attend school|
|IV|internet|internet users (per 100 people). |
|IV|mobile|Mobile cellular subscriptions (per 100 people)|

##Methodology(Descriptive Statistics)
```{r , echo=FALSE, comment=NA, warning=FALSE, error=FALSE, message=FALSE, results='asis'}

stargazer(cdata, type="latex",header = FALSE,
          title= 'Table: Summary statistics of the variables')
```

##Analysis
```{r , echo=FALSE, comment=NA, warning=FALSE, error=FALSE, message=FALSE, results='asis'}
###Create labels
mlabels <- c('log(GDPperc)', 'log(pop)','popd', 'rteacher', 'eyear', 'expend', 'internet','mobile','(intercept)')

###Math
ma.lm <- lm(math ~ log(GDPperc) + log(pop) +  popd, data=data)
ma.lm2 <- lm(math ~ log(GDPperc) + log(pop) +  popd + rteacher + eyear + expend, data = data)
ma.lm3 <- lm(math ~ log(GDPperc) + log(pop) +  popd + rteacher + eyear+ internet + mobile, data = data)
ma.lm4 <- lm(math ~ log(GDPperc) + log(pop) +  popd + rteacher + eyear + expend + internet + mobile, data = data)

###Reading
re.lm <- lm(reading ~ log(GDPperc) + log(pop) +  popd,data = cdata)
re.lm2 <- lm(reading ~ log(GDPperc) + log(pop) +  popd + rteacher + eyear + expend, data = cdata )
re.lm3 <- lm(reading ~ log(GDPperc) + log(pop) +  popd + rteacher + eyear + expend + internet + mobile,data = cdata )

###Problem Solving
ps.lm <- lm(ps ~ log(GDPperc) + log(pop) +  popd, data = cdata)
ps.lm2 <- lm(ps ~ log(GDPperc) + log(pop) +  popd + rteacher + eyear + expend, data = cdata)
ps.lm3 <- lm(ps ~ log(GDPperc) + log(pop) +  popd + rteacher + eyear + expend + internet + mobile, data = cdata)

##Comparison
stargazer(ma.lm,ma.lm2,ma.lm3,re.lm,re.lm2,re.lm3,ps.lm,ps.lm2,ps.lm3,
          type='latex',
          header = FALSE, no.space =TRUE,
          covariate.labels = mlabels,
          title="Table:Detarminants of Student's Ability",
          font.size='tiny')
```

##Analysis of Problem Solving
```{r , echo=FALSE, comment=NA, warning=FALSE, error=FALSE, message=FALSE, results='asis'}

### adding the label based on GDP per capita
glabel <- cut(cdata$GDPperc, breaks=c(1754,10690,20580,31350,45720,149200),
    labels=c("low","middle-low","middle","middle-high","high"),
    right=FALSE,include_lowest=TRUE)
lcdata <- transform(cdata,GDPperc_label=glabel)

###correlation between internet and ps score
pplot <- ggplot(lcdata,aes(x=ps,y=internet))+
  geom_point(aes(colour=GDPperc_label))+
    stat_smooth(method="lm")
plot(pplot)

```

##Analysis of Score Growth
```{r , echo=FALSE, comment=NA, warning=FALSE, error=FALSE, message=FALSE}
##Labeling
g2label <- cut(pisa$GDPperc, breaks=c(1754,10690,20580,31350,45720,149200),
    labels=c("low","middle-low","middle","middle-high","high"),
    right=FALSE,include_lowest=TRUE)
lpisa <- transform(pisa,GDPperc_label=g2label)

##Plot and Correlation
###score growth and the number of internet users
p <- ggplot(lpisa, aes(INTERNET.USERS.2012..per.100.people.,Score.growth))+
  geom_point(aes(colour = GDPperc_label))+
  stat_smooth(method="lm")+
  theme_bw()
plot(p)
```

##Analysis of Score Growth
```{r , echo=FALSE, comment=NA, warning=FALSE, error=FALSE, message=FALSE} 
###Growth of the score and the number of internet users growth
p2 <- ggplot(lpisa, aes(Internet.users.growth, Score.growth))+
  geom_point(aes(colour = GDPperc_label))
plot(p2)
```

##Finding and Limitation
###Finding
- Internet accessiblity would have a strong impact on student's ability.
- However, the impact may weaker on thinking ability than academic ability.
- If the internet accessibility improve, thinking ability might decrease.

###Limitation
- small sample size
- just a comparison between 2003 and 2012


